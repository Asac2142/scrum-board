var App=function(){function t(){p(),e(),s(),r(),d(),a(),n(),c(),o(),i()}function e(){$("#remove").on("click",function(t){t.preventDefault()});var t={id:1,title:"This is a sample task",description:"Sample tasks are useful to get started",remote_url:"https://asana.com/12345/1234",assigned_to:"Jon Doe",status:"pending"};LocalStorage.get("appInitialized",!0)||(LocalStorage.set("taskCounter",1),LocalStorage.set("task-1",JSON.stringify(t)),LocalStorage.set("appInitialized",!0))}function a(){var t=$("#task-card-template").html(),e=Handlebars.compile(t);$("#add-task").on("click",function(t){t.preventDefault(),$("#add-task-modal").removeClass("hide"),$("#add-task-modal").find("form").on("submit",function(t){t.preventDefault();for(var a={},o=$(this).serialize(),i=o.split("&"),n=0,r=i.length;n<r;n++){var d=i[n].split("=");a[d[0]]=unescape(d[1])}if(""!==a.description&&""!==a.title){var l=LocalStorage.get("taskCounter");a.id=++l,a.status="pending",LocalStorage.set("task-"+a.id,JSON.stringify(a)),LocalStorage.set("taskCounter",l);var c=e([a]);$("#dashboard #"+a.status).append(c),s(),$(".close-modal").trigger("click"),$(this).find("input[type=text], textarea").val("")}})})}function o(){$(document).on("dblclick",".card-details p",function(t){t.stopPropagation(),$(this).attr("contenteditable","true").parents(".card").addClass("edit-mode")}),$(document).on("input",".card p",function(){var t=$(this).parents(".card").data("task-id"),e=$(this).data("field"),a=JSON.parse(LocalStorage.get("task-"+t));a[e]=$(this).text(),LocalStorage.set("task-"+t,JSON.stringify(a))})}function i(){$(document).on("dblclick",function(t){$(".card").removeClass("edit-mode").find("[contenteditable]").removeAttr("contenteditable")})}function n(){$(".close-modal").on("click",function(){$(".modal").addClass("hide")})}function s(){$(".card").draggable({handle:"h5",revert:!0,cursor:"move",start:function(t,e){},stop:function(t,e){}})}function r(){var t={tolerance:"pointer",drop:function(t,e){var a=e.draggable,o=a.parent().attr("id"),i=$(this).attr("id"),n=a.data("task-id");if("remove"==$(this).attr("id"))a.remove(),LocalStorage.remove("task-"+n),$("#removed-task-notification").text("Task removed successfully").removeClass("hide"),setTimeout(function(){$("#removed-task-notification").text("").addClass("hide")},3e3);else if(o!=i){$(a).detach().removeAttr("style").appendTo(this);var s=JSON.parse(LocalStorage.get("task-"+n));s.status=i,LocalStorage.set("task-"+n,JSON.stringify(s))}$(this).removeClass("dragged-over")},over:function(t,e){$(this).addClass("dragged-over")},out:function(t,e){$(this).removeClass("dragged-over")}};$("#dashboard > div, #remove").droppable(t)}function d(){$(document).on("click",".expand-card",function(t){$(this).parent().toggleClass("expanded"),t.preventDefault()})}function l(){var t=localStorage,e=[];for(var a in t)"task"==a.split("-")[0]&&e.push(JSON.parse(localStorage[a]));return e}function c(){for(var t=$("#task-card-template").html(),e=Handlebars.compile(t),a=["rejected","pending","development","testing","production"],o=0,i=a.length;o<i;o++){var n=App.getAllNotes().filter(function(t){return t.status==a[o]});if(n){var r=e(n);$("#dashboard #"+a[o]).append(r),s()}}}function p(){JSON.parse(LocalStorage.get("showedTip"))||$("#tips").removeClass("hide").addClass("tips"),$("#tips").on("click",function(){$(this).addClass("hide"),LocalStorage.set("showedTip",!0)})}return{init:t,getAllNotes:l}}();App.init();